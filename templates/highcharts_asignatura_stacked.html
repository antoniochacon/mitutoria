
{% macro highcharts_asignatura_stacked(char_id, asignatura, df_data, df_prueba_evaluable, tutoria_id) %}
	<div id="{{char_id | safe}}" class="chart" style="height: 200px"></div>
	<script>
		Highcharts.chart("{{char_id | safe }}", {
			chart: {
				plotBackgroundColor: null,
				plotBorderWidth: 0,
				plotShadow: false,
				marginBottom: -130,
				spacingBottom: 20
			},
			title: {
				text: "{{asignatura}}",
				align: "center",
				verticalAlign: "bottom",
				// y: 200
			},
			plotOptions: {
				pie: {
					dataLabels: {
						enabled: null
					}
				}
			},
			series: [
				{% if df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[8] %}
					{
						type: "pie",
						size: "32%",
						innerSize: "55%",
						tooltip: {
							pointFormat: "{point.percentage:.1f}"
						},
						startAngle: -90,
						endAngle: 90,
						data: [
							{
								name: "{{titulo}}",
								y: {{df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[8]}},
								color: "#ba68c8"
							}, {
								name: "sin alcanzar",
								y: 10 - {{df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[8]}},
								color: "#f5f5f5",
								states: {
									hover: {
										brightness: -0.3,
										halo: {
											size: 10,
											opacity: 10
										}
									}
								}
							}
						]
					},
				{% endif %}
				{% if df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[9] %}
					{
						type: "pie",
						size: "25%",
						innerSize: "55%",
						tooltip: {
							pointFormat: "{point.percentage:.1f}%"
						},
						startAngle: -90,
						endAngle: 90,
						data: [
							{
								name: "{{titulo}}",
								y: {{df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[9]}},
								color: "#ba68c8"
							}, {
								name: "sin alcanzar",
								y: 10 - {{df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[9]}},
								color: "#f5f5f5",
								states: {
									hover: {
										brightness: -0.3,
										halo: {
											size: 10,
											opacity: 10
										}
									}
								}
							}
						]
					},
				{% else %}
					{
						type: "pie",
						size: "25%",
						innerSize: "55%",
						tooltip: {
							pointFormat: "Sin pruebas evaluables"
						},
						startAngle: -90,
						endAngle: 90,
						data: [
							{
								name: "{{titulo}}",
								y: 100,
								color: "#ffffff"
							}
						]
					},
				{% endif %}
				{
					type: "pie",
					size: "65%",
					innerSize: "75%",
					tooltip: {
						pointFormat: "{point.percentage:.1f}%"
					},
					startAngle: -90,
					endAngle: 90,
					data: [
							{% set brightness_inicio=59 %}
						{% set brightness_final=85 %}
						{% set brightness_ticker= (brightness_final-brightness_inicio)/df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[0] | count %}
						{% for cuestionario in df_analisis_asignatura(df_data,df_prueba_evaluable,tutoria_id,asignatura)[4] %}
							{
								name: "{{cuestionario[0]}}",
								y: {{cuestionario[1]}},
								color: "hsl(340, 82%, {{brightness_inicio+loop.index*brightness_ticker}}%)"
							},
						{% endfor %}{
							name: "sin alcanzar",
							y: {{df_analisis_asignatura(df_data,df_prueba_evaluable,tutoria_id,asignatura)[6]}},
							color: "#f5f5f5",
							states: {
								hover: {
									brightness: -0.3,
									halo: {
										size: 10,
										opacity: 10
									}
								}
							}
						}
					]
				}, {
					type: "pie",
					size: "58%",
					innerSize: "65%",
					tooltip: {
						pointFormat: "{point.percentage:.1f}%"
					},
					startAngle: -90,
					endAngle: 90,
					data: [
							{% set brightness_inicio=59 %}
						{% set brightness_final=85 %}
						{% set brightness_ticker= (brightness_final-brightness_inicio)/df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[0] | count %}
						{% for cuestionario in df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[5] %}
							{
								name: "{{cuestionario[0]}}",
								y: {{cuestionario[1]}},
								color: "hsl(340, 82%, {{brightness_inicio+loop.index*brightness_ticker}}%)"
							},
						{% endfor %}
						{
							name: "sin alcanzar",
							y: {{df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[7]}},
							color: "#f5f5f5",
							states: {
								hover: {
									brightness: -0.3,
									halo: {
										size: 10,
										opacity: 10
									}
								}
							}
						}
					]
				}, {
					type: "pie",
					size: "100%",
					innerSize: "75%",
					tooltip: {
						pointFormat: "{point.percentage:.1f}%"
					},
					startAngle: -90,
					endAngle: 90,
					data: [
							{% set brightness_inicio=50 %}
						{% set brightness_final=85 %}
						{% set brightness_ticker= (brightness_final-brightness_inicio)/df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[0] | count %}
						{% for cuestionario in df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[0] %}
							{
								name: "{{cuestionario[0]}}",
								y: {{cuestionario[1]}},
								color: "hsl(36, 100%, {{brightness_inicio+loop.index*brightness_ticker}}%)"
							},
						{% endfor %}{
							name: "sin alcanzar",
							y: {{df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[2]}},
							color: "#f5f5f5",
							states: {
								hover: {
									brightness: -0.3,
									halo: {
										size: 10,
										opacity: 10
									}
								}
							}
						}
					]
				}, {
					type: "pie",
					size: "93%",
					innerSize: "75%",
					tooltip: {
						pointFormat: "{point.percentage:.1f}%"
					},
					startAngle: -90,
					endAngle: 90,
					data: [
							{% set brightness_inicio=50 %}
						{% set brightness_final=85 %}
						{% set brightness_ticker= (brightness_final-brightness_inicio)/df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[0] | count %}
						{% for cuestionario in df_analisis_asignatura(df_data,df_prueba_evaluable, tutoria_id,asignatura)[1] %}
							{
								name: "{{cuestionario[0]}}",
								y: {{cuestionario[1]}},
								color: "hsl(36, 100%, {{brightness_inicio+loop.index*brightness_ticker}}%)"
							},
						{% endfor %}
						{
							name: "sin alcanzar",
							y: {{df_analisis_asignatura(df_data,df_prueba_evaluable,tutoria_id,asignatura)[3]}},
							color: "#f5f5f5",
							states: {
								hover: {
									brightness: -0.3,
									halo: {
										size: 10,
										opacity: 10
									}
								}
							}
						}
					]
				}
			]
		});
	</script>
{% endmacro %}
